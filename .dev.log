
> muj-web@0.1.0 dev
> next dev -p 3000

  ‚ñ≤ Next.js 14.2.24
  - Local:        http://localhost:3000
  - Environments: .env.local, .env.development, .env
  - Experiments (use with caution):
    ¬∑ optimizeServerReact

 ‚úì Starting...
 ‚úì Ready in 4.4s
 ‚úì Compiled /middleware in 486ms
 ‚®Ø ./middleware.ts
Error: 
  [31mx[0m the name `NextResponse` is defined multiple times
    ,-[[36;1;4m/Users/petrliesner/ai new new new/middleware.ts[0m:1:1]
 [2m 1[0m | import { NextResponse, NextRequest } from 'next/server'
    : [31;1m         ^^^^^^|^^^^^[0m
    :                [31;1m`-- [31;1mprevious definition of `NextResponse` here[0m[0m
 [2m 2[0m | 
 [2m 3[0m | // Force base URL host to NEXT_PUBLIC_BASE_URL host when present
 [2m 4[0m | export function middleware(request: NextRequest) {
 [2m 5[0m |   const base = process.env.NEXT_PUBLIC_BASE_URL
 [2m 6[0m |   if (!base) return NextResponse.next()
 [2m 7[0m | 
 [2m 8[0m |   try {
 [2m 9[0m |     const url = new URL(request.url)
 [2m10[0m |     const wanted = new URL(base)
 [2m11[0m |     // If host/proto differ from configured base, redirect (308) to base host
 [2m12[0m |     if (url.host !== wanted.host || url.protocol !== wanted.protocol) {
 [2m13[0m |       url.host = wanted.host
 [2m14[0m |       url.protocol = wanted.protocol
 [2m15[0m |       return NextResponse.redirect(url, { status: 308 })
 [2m16[0m |     }
 [2m17[0m |   } catch {
 [2m18[0m |     // noop
 [2m19[0m |   }
 [2m20[0m |   return NextResponse.next()
 [2m21[0m | }
 [2m22[0m | 
 [2m23[0m | export const config = {
 [2m24[0m |   matcher: [
 [2m25[0m |     '/((?!_next|api|static|favicon.ico|robots.txt|sitemap.xml).*)',
 [2m26[0m |   ],
 [2m27[0m | }
 [2m28[0m | 
 [2m29[0m | import { NextRequest, NextResponse } from 'next/server';
    : [33;1m                      ^^^^^^|^^^^^[0m
    :                             [33;1m`-- [33;1m`NextResponse` redefined here[0m[0m
 [2m30[0m | import { getToken } from 'next-auth/jwt';
 [2m31[0m | 
 [2m32[0m | // üöÄ ƒåIST√â JEDNODUCH√â MIDDLEWARE - JEN ROUTING PODLE ROLE
    `----

  [31mx[0m the name `middleware` is defined multiple times
    ,-[[36;1;4m/Users/petrliesner/ai new new new/middleware.ts[0m:1:1]
 [2m 1[0m | import { NextResponse, NextRequest } from 'next/server'
 [2m 2[0m | 
 [2m 3[0m | // Force base URL host to NEXT_PUBLIC_BASE_URL host when present
 [2m 4[0m | export function middleware(request: NextRequest) {
    : [31;1m                ^^^^^|^^^^[0m
    :                      [31;1m`-- [31;1mprevious definition of `middleware` here[0m[0m
 [2m 5[0m |   const base = process.env.NEXT_PUBLIC_BASE_URL
 [2m 6[0m |   if (!base) return NextResponse.next()
 [2m 7[0m | 
 [2m 8[0m |   try {
 [2m 9[0m |     const url = new URL(request.url)
 [2m10[0m |     const wanted = new URL(base)
 [2m11[0m |     // If host/proto differ from configured base, redirect (308) to base host
 [2m12[0m |     if (url.host !== wanted.host || url.protocol !== wanted.protocol) {
 [2m13[0m |       url.host = wanted.host
 [2m14[0m |       url.protocol = wanted.protocol
 [2m15[0m |       return NextResponse.redirect(url, { status: 308 })
 [2m16[0m |     }
 [2m17[0m |   } catch {
 [2m18[0m |     // noop
 [2m19[0m |   }
 [2m20[0m |   return NextResponse.next()
 [2m21[0m | }
 [2m22[0m | 
 [2m23[0m | export const config = {
 [2m24[0m |   matcher: [
 [2m25[0m |     '/((?!_next|api|static|favicon.ico|robots.txt|sitemap.xml).*)',
 [2m26[0m |   ],
 [2m27[0m | }
 [2m28[0m | 
 [2m29[0m | import { NextRequest, NextResponse } from 'next/server';
 [2m30[0m | import { getToken } from 'next-auth/jwt';
 [2m31[0m | 
 [2m32[0m | // üöÄ ƒåIST√â JEDNODUCH√â MIDDLEWARE - JEN ROUTING PODLE ROLE
 [2m33[0m | export async function middleware(request: NextRequest) {
    : [33;1m                      ^^^^^|^^^^[0m
    :                            [33;1m`-- [33;1m`middleware` redefined here[0m[0m
 [2m34[0m |   const pathname = request.nextUrl.pathname;
 [2m35[0m |   
 [2m36[0m |   // Skip middleware for auth endpoints and static files
    `----

  [31mx[0m the name `config` is defined multiple times
     ,-[[36;1;4m/Users/petrliesner/ai new new new/middleware.ts[0m:20:1]
 [2m 20[0m |   return NextResponse.next()
 [2m 21[0m | }
 [2m 22[0m | 
 [2m 23[0m | export const config = {
     : [31;1m             ^^^|^^[0m
     :                 [31;1m`-- [31;1mprevious definition of `config` here[0m[0m
 [2m 24[0m |   matcher: [
 [2m 25[0m |     '/((?!_next|api|static|favicon.ico|robots.txt|sitemap.xml).*)',
 [2m 26[0m |   ],
 [2m 27[0m | }
 [2m 28[0m | 
 [2m 29[0m | import { NextRequest, NextResponse } from 'next/server';
 [2m 30[0m | import { getToken } from 'next-auth/jwt';
 [2m 31[0m | 
 [2m 32[0m | // üöÄ ƒåIST√â JEDNODUCH√â MIDDLEWARE - JEN ROUTING PODLE ROLE
 [2m 33[0m | export async function middleware(request: NextRequest) {
 [2m 34[0m |   const pathname = request.nextUrl.pathname;
 [2m 35[0m |   
 [2m 36[0m |   // Skip middleware for auth endpoints and static files
 [2m 37[0m |   if (
 [2m 38[0m |     pathname.startsWith('/api/auth') ||
 [2m 39[0m |     pathname.startsWith('/_next') ||
 [2m 40[0m |     pathname.startsWith('/favicon') ||
 [2m 41[0m |     pathname.includes('.')
 [2m 42[0m |   ) {
 [2m 43[0m |     return NextResponse.next();
 [2m 44[0m |   }
 [2m 45[0m | 
 [2m 46[0m |   try {
 [2m 47[0m |     // Get user token and role
 [2m 48[0m |     const token = await getToken({ 
 [2m 49[0m |       req: request,
 [2m 50[0m |       secret: process.env.NEXTAUTH_SECRET
 [2m 51[0m |     });
 [2m 52[0m | 
 [2m 53[0m |     const userRole = token?.role as string | null;
 [2m 54[0m |     console.log(`üîç Middleware: ${pathname} | Role: ${userRole || 'none'}`);
 [2m 55[0m | 
 [2m 56[0m |     // üîê ADMIN ROUTES - require admin role
 [2m 57[0m |     if (pathname.startsWith('/admin')) {
 [2m 58[0m |       if (userRole !== 'admin') {
 [2m 59[0m |         console.log(`‚ùå Access denied: Admin route requires admin role (current: ${userRole})`);
 [2m 60[0m |         return NextResponse.redirect(new URL('/auth/login', request.url));
 [2m 61[0m |       }
 [2m 62[0m |       console.log('‚úÖ Admin access granted');
 [2m 63[0m |       return NextResponse.next();
 [2m 64[0m |     }
 [2m 65[0m | 
 [2m 66[0m |     // üë§ USER ROUTES - require user role (except login page)
 [2m 67[0m |     if (pathname.startsWith('/user-area')) {
 [2m 68[0m |       if (userRole !== 'user' && pathname !== '/user-area/login') {
 [2m 69[0m |         console.log(`‚ùå Access denied: User route requires user role (current: ${userRole})`);
 [2m 70[0m |         return NextResponse.redirect(new URL('/user-area/login', request.url));
 [2m 71[0m |       }
 [2m 72[0m |       console.log('‚úÖ User access granted');
 [2m 73[0m |       return NextResponse.next();
 [2m 74[0m |     }
 [2m 75[0m | 
 [2m 76[0m |     // üè¢ COMPANY ROUTES - require company role (except main page and public profile alias)
 [2m 77[0m |     if (pathname === '/company/profile') {
 [2m 78[0m |       // Public alias ‚Äì m√° zobrazit stejn√Ω obsah jako /company
 [2m 79[0m |       return NextResponse.next();
 [2m 80[0m |     }
 [2m 81[0m |     if (pathname.startsWith('/company/')) {
 [2m 82[0m |       if (userRole !== 'company') {
 [2m 83[0m |         console.log(`‚ùå Access denied: Company route requires company role (current: ${userRole})`);
 [2m 84[0m |         return NextResponse.redirect(new URL('/company', request.url));
 [2m 85[0m |       }
 [2m 86[0m |       console.log('‚úÖ Company access granted');
 [2m 87[0m |       return NextResponse.next();
 [2m 88[0m |     }
 [2m 89[0m | 
 [2m 90[0m |     // üìÑ PUBLIC ROUTES - allow everyone
 [2m 91[0m |     console.log('üåê Public route access');
 [2m 92[0m |     return NextResponse.next();
 [2m 93[0m | 
 [2m 94[0m |   } catch (error) {
 [2m 95[0m |     console.log('‚ùå Middleware error:', error);
 [2m 96[0m |     return NextResponse.next();
 [2m 97[0m |   }
 [2m 98[0m | }
 [2m 99[0m | 
 [2m100[0m | export const config = {
     : [33;1m             ^^^|^^[0m
     :                 [33;1m`-- [33;1m`config` redefined here[0m[0m
 [2m101[0m |   matcher: [
 [2m102[0m |     '/admin/:path*',
 [2m103[0m |     '/user-area/:path*', 
     `----
 ‚óã Compiling /_error ...
 ‚úì Compiled /_error in 1521ms (250 modules)
 ‚óã Compiling /api/product-count ...
 ‚úì Compiled /api/product-count in 2s (92 modules)
 GET /api/product-count 500 in 2067ms
 ‚úì Compiled in 781ms (171 modules)
